<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™‚å…‰è¡Œè€…ï¼šç§¦æ¼¢é¢¨é›²éŒ„ (å²å¯¦æ²‰æµ¸ç‰ˆ)</title>
    
    <!-- éŒ¯èª¤è™•ç† -->
    <script>
        window.onerror = function(msg, url, line, col, error) {
            var errorDiv = document.getElementById('error-display');
            if (!errorDiv) {
                errorDiv = document.createElement('div');
                errorDiv.id = 'error-display';
                errorDiv.style.background = '#ef4444';
                errorDiv.style.color = 'white';
                errorDiv.style.padding = '20px';
                errorDiv.style.position = 'fixed';
                errorDiv.style.top = '0';
                errorDiv.style.left = '0';
                errorDiv.style.width = '100%';
                errorDiv.style.zIndex = '9999';
                document.body.appendChild(errorDiv);
            }
            errorDiv.innerHTML = '<strong>âš ï¸ ç¨‹å¼åŸ·è¡ŒéŒ¯èª¤ï¼š</strong> ' + msg;
            return false;
        };
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Serif TC', serif;
            background-color: #1a1a1a;
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .scroll-container {
            background-color: #fdf6e3;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4c5a9' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        /* æµ®å‹•æ•¸å€¼å‹•ç•« */
        .stat-float {
            position: absolute;
            animation: floatUp 2s ease-out forwards;
            font-weight: bold;
            pointer-events: none;
            z-index: 50;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
            font-size: 1.1rem;
        }
        @keyframes floatUp {
            0% { opacity: 0; transform: translateY(10px) scale(0.8); }
            20% { opacity: 1; transform: translateY(0) scale(1.1); }
            100% { opacity: 0; transform: translateY(-60px) scale(1); }
        }
        
        /* æ»¾å‹•æ¢ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #eaddcf; }
        ::-webkit-scrollbar-thumb { background: #8b5e3c; border-radius: 4px; }
    </style>
</head>
<body>
    <div id="root" class="min-h-screen flex items-center justify-center text-white">
        <div class="text-center p-4">
            <h1 class="text-2xl mb-2 animate-pulse">æ­£åœ¨è¼‰å…¥æ­·å²å·è»¸...</h1>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- SVG Icons ---
        const Icons = {
            Heart: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill={className?.includes('text-red') ? "currentColor" : "none"} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
            Brain: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/></svg>,
            Coin: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"/><path d="M12 18V6"/></svg>,
            Star: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            ArrowRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
            Refresh: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Award: () => <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
            History: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>,
            Backpack: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z"/><path d="M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/><path d="M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5"/><path d="M8 10h8"/><path d="M9 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5"/></svg>,
            Sword: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" x2="19" y1="19" y2="13"/><line x1="16" x2="20" y1="16" y2="20"/><line x1="19" x2="21" y1="21" y2="19"/></svg>,
            Map: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" x2="8" y1="2" y2="18"/><line x1="16" x2="16" y1="6" y2="22"/></svg>,
            Hourglass: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"/><path d="M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"/></svg>,
            Crown: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>,
            Scroll: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 20H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
            Hammer: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>,
            Scale: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>,
            Person: () => <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        };

        // --- æ­·å²åŠ‡æœ¬è³‡æ–™ (å«å²å¯¦è£œå……) ---
        const storyNodes = {
            "intro": {
                id: "intro",
                title: "æ­·å²èª²çš„å¬å–š",
                text: "è¥¿å…ƒ2024å¹´ã€‚æ­·å²èª²ä¸Šï¼Œè€å¸«è¬›è¿°è‘—ï¼šã€Œç§¦çš‡æ¼¢æ­¦ï¼Œç•¥è¼¸æ–‡é‡‡...ã€ä½ çš„æ€ç·’é£„å‘äº†å…©åƒå¹´å‰çš„æ™‚ç©ºæ¼©æ¸¦ã€‚",
                imageType: "classroom",
                options: [
                    { text: "èªçœŸè½èª²", nextId: "qin_war", effect: { knowledge: 10 }, feedback: "çŸ¥è­˜å°±æ˜¯åŠ›é‡ã€‚", historyNote: "æ­·å²å­¸ç¿’èƒ½å¹«åŠ©æˆ‘å€‘ä»¥å¤é‘‘ä»Šï¼Œäº†è§£æœä»£èˆˆè¡°çš„è¦å¾‹ã€‚" },
                    { text: "ç¡è¦ºå„²å­˜é«”åŠ›", nextId: "qin_war", effect: { health: 10 }, feedback: "ç²¾ç¥é£½æ»¿åœ°ç©¿è¶Šäº†ã€‚", historyNote: "ç©¿è¶Šå°èªªä¸­ï¼Œä¸»è§’å¾€å¾€æ˜¯åœ¨ç¡å¤¢æˆ–æ„å¤–ä¸­å›åˆ°å¤ä»£ã€‚" }
                ]
            },
            "qin_war": {
                id: "qin_war",
                title: "1. ç§¦æ»…å…­åœ‹ (è¥¿å…ƒå‰230-221å¹´)",
                text: "ä½ ç½®èº«æ–¼ç§¦è»å¤§å¸³ã€‚ç§¦ç‹å¬´æ”¿æ¬²ä¸€çµ±å¤©ä¸‹ï¼Œæ»…åœ‹ä¹‹æˆ°ä¸€è§¸å³ç™¼ã€‚",
                imageType: "sword",
                options: [
                    { text: "ç»è¨ˆã€Œé äº¤è¿‘æ”»ã€", nextId: "qin_system", effect: { knowledge: 15, reputation: 10, health: -5, wealth: 10 }, feedback: "ä½ çš„ç­–ç•¥åŠ é€Ÿäº†å…­åœ‹çš„æ»…äº¡ï¼", historyNote: "èŒƒé›å‘ç§¦æ˜­ç‹æå‡ºã€Œé äº¤è¿‘æ”»ã€ï¼Œå…ˆæ”»æ‰“é„°è¿‘çš„éŸ“é­ï¼Œæš«æ™‚è¯çµ¡é æ–¹çš„é½Šåœ‹ï¼Œé€™æ˜¯ç§¦çµ±ä¸€çš„é—œéµæˆ°ç•¥ã€‚" },
                    { text: "è¦ªä¸Šå‰ç·šæ®ºæ•µ", nextId: "qin_system", effect: { health: -10, wealth: 20, reputation: 5 }, feedback: "ä½ ç²å¾—äº†ç§¦åœ‹çš„è»åŠŸçˆµä½ã€‚", historyNote: "å•†é…è®Šæ³•å¾Œï¼Œç§¦åœ‹å¯¦è¡Œè»åŠŸçˆµåˆ¶ï¼Œå¹³æ°‘å¯ä»¥é€šéæ–¬é¦–æ•µè»ç²å¾—çˆµä½å’Œç”°å®…ï¼Œå¤§å¤§æ¿€å‹µäº†ç§¦è»æˆ°é¬¥åŠ›ã€‚" },
                    { text: "æ“”ä»»è»éœ€å®˜", nextId: "qin_system", effect: { wealth: 30, reputation: -5 }, feedback: "ä½ ç¢ºä¿äº†ç³§è‰å……è¶³ã€‚", historyNote: "ç§¦åœ‹æ“æœ‰ç™¼é”çš„è¾²æ¥­å’Œæ°´åˆ©ï¼ˆå¦‚é„­åœ‹æ¸ ã€éƒ½æ±Ÿå °ï¼‰ï¼Œç‚ºçµ±ä¸€æˆ°çˆ­æä¾›äº†å …å¯¦çš„å¾Œå‹¤ä¿éšœã€‚" }
                ]
            },
            "qin_system": {
                id: "qin_system",
                title: "2. åˆ¶åº¦ä¹‹çˆ­ (è¥¿å…ƒå‰221å¹´)",
                text: "å¤©ä¸‹åˆå®šï¼Œæœå»·ä¸Šæ­£åœ¨çˆ­è«–å¯¦è¡Œã€Œéƒ¡ç¸£åˆ¶ã€é‚„æ˜¯ã€Œåˆ†å°åˆ¶ã€ã€‚",
                imageType: "crown",
                options: [
                    { text: "æ”¯æŒææ–¯ï¼Œæ¨è¡Œéƒ¡ç¸£åˆ¶", nextId: "qin_standard", effect: { knowledge: 20, reputation: 10 }, feedback: "ç§¦å§‹çš‡æ¡ç´äº†å»ºè­°ï¼Œä¸­å¤®é›†æ¬Šç¢ºç«‹ï¼", historyNote: "ææ–¯åå°åˆ†å°å­å¼Ÿï¼Œèªç‚ºé€™æœƒå°è‡´åƒå‘¨æœä¸€æ¨£çš„è«¸ä¾¯æ··æˆ°ã€‚ç§¦å§‹çš‡æœ€çµ‚å°‡å¤©ä¸‹åˆ†ç‚ºä¸‰åå…­éƒ¡ï¼Œç”±ä¸­å¤®ç›´æ¥ç®¡è½„ã€‚" },
                    { text: "æ”¯æŒç‹ç¶°ï¼Œä¸»å¼µåˆ†å°", nextId: "qin_standard", effect: { reputation: -10 }, feedback: "ç§¦å§‹çš‡é§å›äº†ä½ çš„å»ºè­°ã€‚", historyNote: "ç‹ç¶°èªç‚ºç‡•ã€é½Šã€æ¥šç­‰åœ°åé ï¼Œä¸åˆ†å°ç‹ä¾¯é›£ä»¥é®å®ˆï¼Œä½†æ­¤è§€é»æœªè¢«æ¡ç´ã€‚" },
                    { text: "ä¿æŒæ²ˆé»˜", nextId: "qin_standard", effect: { health: 0 }, feedback: "ä½ é¸æ“‡äº†æ—è§€ã€‚", historyNote: "åœ¨ç§¦æœå»·è­°ä¸­ï¼Œå®˜å“¡å¯ä»¥è¡¨é”æ„è¦‹ï¼Œä½†æœ€çµ‚æ±ºç­–æ¬Šåœ¨çš‡å¸æ‰‹ä¸­ã€‚" }
                ]
            },
            "qin_standard": {
                id: "qin_standard",
                title: "3. è»ŠåŒè»Œï¼Œæ›¸åŒæ–‡ (è¥¿å…ƒå‰221å¹´)",
                text: "ç§¦å§‹çš‡ä¸‹ä»¤çµ±ä¸€åº¦é‡è¡¡ã€è²¨å¹£èˆ‡æ–‡å­—ã€‚å¸‚äº•ä¹‹é–“ï¼ŒèˆŠè²¨å¹£èˆ‡èˆŠæ–‡å­—æ­£åœ¨è¢«å»¢é™¤ã€‚",
                imageType: "scale",
                options: [
                    { text: "å­¸ç¿’ä¸¦æ¨å»£å°ç¯† (éœ€æ™ºåŠ›20)", nextId: "qin_construction", reqKnowledge: 20, effect: { knowledge: 15, reputation: 10, wealth: 10 }, feedback: "ä½ æˆç‚ºäº†æ–°æ–‡å­—çš„æ¨å»£è€…ã€‚", historyNote: "ç§¦çµ±ä¸€æ–‡å­—ç‚ºå°ç¯†ï¼ˆå¾Œæ¼”è®Šç‚ºéš¸æ›¸ï¼‰ï¼Œé€™å°ä¸­è¯æ–‡åŒ–çš„å‚³æ‰¿å’Œçµ±ä¸€æœ‰è‘—æ±ºå®šæ€§çš„å½±éŸ¿ã€‚" },
                    { text: "å…Œæ›ç§¦åŠå…©éŒ¢", nextId: "qin_construction", effect: { wealth: 20 }, feedback: "ä½ åˆ©ç”¨è²¨å¹£çµ±ä¸€çš„æ©Ÿæœƒè³ºäº†ä¸€ç­†ã€‚", historyNote: "ç§¦å§‹çš‡å»¢é™¤å…­åœ‹è²¨å¹£ï¼Œè¦å®šä»¥åœ“å½¢æ–¹å­”çš„ã€Œç§¦åŠå…©ã€ç‚ºé€šè¡Œè²¨å¹£ï¼Œé€™ç¨®å½¢åˆ¶æ²¿ç”¨äº†å…©åƒå¤šå¹´ã€‚" },
                    { text: "ç§è—å…­åœ‹èˆŠå¹£", nextId: "qin_construction", effect: { wealth: -10, reputation: -5 }, feedback: "èˆŠå¹£æˆäº†å»¢éŠ…çˆ›éµã€‚", historyNote: "çµ±ä¸€åº¦é‡è¡¡ï¼ˆåº¦ï¼šé•·åº¦ï¼Œé‡ï¼šå®¹ç©ï¼Œè¡¡ï¼šé‡é‡ï¼‰æ¶ˆé™¤äº†å„åœ°è²¿æ˜“éšœç¤™ï¼Œä½†ä¹Ÿè®“èˆŠæ¨™æº–å¤±æ•ˆã€‚" }
                ]
            },
            "qin_construction": {
                id: "qin_construction",
                title: "4. é•·åŸèˆ‡é˜¿æˆ¿å®® (è¥¿å…ƒå‰215å¹´)",
                text: "åŒ—æ–¹åŒˆå¥´å¨è„…ï¼Œå—æ–¹å¾è¨ç™¾è¶Šã€‚ç§¦å§‹çš‡åŒæ™‚ä¸‹ä»¤ä¿®ç¯‰é•·åŸã€é¦³é“èˆ‡é˜¿æˆ¿å®®ï¼Œå¾­å½¹ç¹é‡ã€‚",
                imageType: "hammer",
                options: [
                    { text: "åƒèˆ‡ä¿®ç¯‰é•·åŸ (éœ€é«”åŠ›30)", nextId: "qin_law", reqHealth: 30, effect: { health: -30, reputation: 20, wealth: 10 }, feedback: "å­Ÿå§œå¥³çš„å“­è²çŒ¶åœ¨è€³é‚Šï¼Œä½†ä½ å®ˆè­·äº†é‚Šç–†ã€‚", historyNote: "ç§¦é•·åŸè¥¿èµ·è‡¨æ´®ï¼Œæ±è‡³é¼æ±ã€‚é›–ç„¶é˜²ç¦¦äº†åŒˆå¥´ï¼Œä½†ç¹é‡çš„å¾­å½¹ä¹Ÿæ˜¯ç§¦æœæ»…äº¡çš„é‡è¦åŸå› ã€‚" },
                    { text: "æè³‡ä»¥æ­¤å…é™¤å‹å½¹ (éœ€è²¡å¯Œ40)", nextId: "qin_law", reqWealth: 40, effect: { wealth: -40, health: 10, reputation: -5 }, feedback: "æœ‰éŒ¢èƒ½ä½¿é¬¼æ¨ç£¨ï¼Œä½ èº²éäº†è‹¦å½¹ã€‚", historyNote: "ç§¦å¾‹å…è¨±é€šéç¹³ç´ç½°é‡‘ï¼ˆè²²ï¼‰æˆ–ç³§é£Ÿä¾†è´–ç½ªæˆ–å…é™¤éƒ¨åˆ†å‹å½¹ï¼Œé«”ç¾äº†æ³•å¾‹çš„éšç´šæ€§ã€‚" },
                    { text: "é€ƒé¿å‹å½¹è¢«æŠ“", nextId: "qin_law", effect: { health: -50, wealth: -20, reputation: -10 }, feedback: "ä½ è¢«æŠ“å»ä¿®é¦³é“ï¼Œå—ç›¡æŠ˜ç£¨ã€‚", historyNote: "ç§¦æœæ³•å¾‹åš´è‹›ï¼Œé€ƒé¿å¾­å½¹æœƒå—åˆ°åš´å²æ‡²ç½°ï¼Œç”šè‡³è¢«ç½°ç‚ºã€ŒåŸæ—¦èˆ‚ã€ï¼ˆç¯‰åŸæˆ–èˆ‚ç±³ï¼‰ã€‚" }
                ]
            },
            "qin_law": {
                id: "qin_law",
                title: "5. é€£åæ³•ä¹‹å¨ (è¥¿å…ƒå‰213å¹´)",
                text: "ç§¦æ³•åš´è‹›ï¼Œå¯¦è¡Œé€£åã€‚é„°å±…çŠ¯æ³•ï¼Œä½ ä¹Ÿå¯èƒ½å—ç‰½é€£ã€‚è·¯ä¸Šå¶é‡ã€ææ–¯ã€‘ã€‚",
                imageType: "scroll",
                options: [
                    { text: "å‘ææ–¯è«‹æ•™æ³•å®¶æ€æƒ³", nextId: "qin_burn", effect: { knowledge: 20, reputation: -10 }, feedback: "ææ–¯ï¼šã€Œä»¥æ³•ç‚ºæ•™ï¼Œä»¥åç‚ºå¸«ã€‚ã€ä½ æ·±æ„Ÿéœ‡æ’¼ã€‚", historyNote: "éŸ“éå­çš„æ³•å®¶æ€æƒ³æ˜¯ç§¦æœçµ±æ²»çš„ç†è«–åŸºç¤ï¼Œå¼·èª¿å›ä¸»é›†æ¬Šã€åš´åˆ‘å³»æ³•å’Œä»¥æ³•æ²»åœ‹ã€‚" },
                    { text: "èˆ‰å ±é„°å±…å·ç›œ", nextId: "qin_burn", effect: { wealth: 30, reputation: -20 }, feedback: "ä½ ç²å¾—äº†è³é‡‘ï¼Œä½†é„°é‡Œè¦–ä½ ç‚ºæƒ¡äººã€‚", historyNote: "å•†é…è®Šæ³•è¨­ç«‹ã€Œä»€ä¼é€£åã€ï¼Œä¸€å®¶çŠ¯æ³•ï¼Œé„°é‡Œè‹¥ä¸å‘Šç™¼å‰‡åŒç½ªï¼Œå‘Šç™¼å‰‡æœ‰è³ã€‚" },
                    { text: "å¹«åŠ©é„°å±…éš±ç", nextId: "qin_burn", effect: { reputation: 20, health: -20 }, feedback: "ä½ ä¿ä½äº†é„°å±…ï¼Œä½†æ™‚åˆ»æ“”å¿ƒè¢«ç™¼ç¾ã€‚", historyNote: "å„’å®¶ä¸»å¼µã€Œçˆ¶ç‚ºå­éš±ï¼Œå­ç‚ºçˆ¶éš±ã€ï¼Œé€™èˆ‡æ³•å®¶çš„é€£åç²¾ç¥æ˜¯èƒŒé“è€Œé¦³çš„ã€‚" }
                ]
            },
            "qin_burn": {
                id: "qin_burn",
                title: "6. ç„šæ›¸å‘å„’ (è¥¿å…ƒå‰213å¹´)",
                text: "åšå£«æ·³äºè¶Šå»ºè­°åˆ†å°ï¼Œè§¸æ€’å§‹çš‡ã€‚ææ–¯å»ºè­°ç„šæ›¸ã€‚å’¸é™½åŸå…§ç«å…‰æ²–å¤©ã€‚",
                imageType: "fire",
                options: [
                    { text: "å†’æ­»è—æ›¸ (éœ€é«”åŠ›20)", nextId: "qin_end", reqHealth: 20, effect: { reputation: 30, health: -20, knowledge: 10 }, feedback: "ä½ ä¿ä½äº†æ–‡åŒ–çš„ç«ç¨®ã€‚", historyNote: "ç§¦å§‹çš‡ä¸‹ä»¤ç‡’æ¯€æ°‘é–“è—æ›¸ï¼Œåªä¿ç•™é†«è—¥ã€åœç­®ã€ç¨®æ¨¹ä¹‹æ›¸ï¼Œä¸¦æ´»åŸ‹äº†460å¤šåæ–¹å£«å’Œå„’ç”Ÿã€‚" },
                    { text: "äº¤å‡ºè—æ›¸", nextId: "qin_end", effect: { reputation: -10, knowledge: -5 }, feedback: "ä½ é¸æ“‡äº†é †å¾ã€‚", historyNote: "ç„šæ›¸å‘å„’å°å…ˆç§¦æ–‡åŒ–é€ æˆäº†æ¯€æ»…æ€§æ‰“æ“Šï¼Œè¨±å¤šå…¸ç±å¾æ­¤å¤±å‚³ã€‚" }
                ]
            },
            "qin_end": {
                id: "qin_end",
                title: "7. å¸åœ‹å´©å¡Œ (è¥¿å…ƒå‰207å¹´)",
                text: "å§‹çš‡é§•å´©ï¼Œç§¦äºŒä¸–æš´æ”¿ã€‚é™³å‹å³å»£èµ·ç¾©ï¼Œå¤©ä¸‹å¤§äº‚ã€‚åŠ‰é‚¦æ”»å…¥å’¸é™½ã€‚",
                imageType: "rebellion",
                options: [
                    { text: "æŠ•é åŠ‰é‚¦", nextId: "han_early", effect: { knowledge: 10, reputation: 10, wealth: 10 }, feedback: "ä½ é¸æ“‡äº†æ­£ç¢ºçš„éšŠä¼ï¼Œç´„æ³•ä¸‰ç« å¾—æ°‘å¿ƒã€‚", historyNote: "åŠ‰é‚¦é€²å…¥å’¸é™½å¾Œï¼Œå»¢é™¤ç§¦æœè‹›æ³•ï¼Œèˆ‡çˆ¶è€ç´„æ³•ä¸‰ç« ï¼šã€Œæ®ºäººè€…æ­»ï¼Œå‚·äººåŠç›œæŠµç½ªã€ï¼Œè´å¾—äº†æ°‘å¿ƒã€‚" },
                    { text: "æŠ•é é …ç¾½", nextId: "han_early", effect: { health: 10, wealth: 10, reputation: -5 }, feedback: "é …ç¾½ç«ç‡’é˜¿æˆ¿å®®ï¼Œä½ é›–æ¶å¾—è²¡å¯¶ï¼Œå»æ„Ÿå˜†æ–‡æ˜æ¯€æ»…ã€‚", historyNote: "é …ç¾½é›–ç„¶å‹‡çŒ›ï¼Œä½†å± åŸå’Œç«ç‡’é˜¿æˆ¿å®®çš„è¡Œç‚ºå¤±å»äº†æ°‘å¿ƒï¼Œæœ€çµ‚åœ¨æ¥šæ¼¢ç›¸çˆ­ä¸­æ•—çµ¦äº†åŠ‰é‚¦ã€‚" }
                ]
            },
            "han_early": {
                id: "han_early",
                title: "8. é»ƒè€ä¹‹è¡“ (è¥¿å…ƒå‰202-180å¹´)",
                text: "æ¼¢æœåˆå»ºï¼Œæ°‘ç”Ÿå‡‹æ•ã€‚æœå»·æ¨è¡Œã€Œç„¡ç‚ºè€Œæ²»ã€ï¼Œä¼‘é¤Šç”Ÿæ¯ã€‚",
                imageType: "farm",
                options: [
                    { text: "éŸ¿æ‡‰æ­¸è¾²ï¼Œé–‹å¢¾è’åœ°", nextId: "han_wenjing", effect: { health: 10, wealth: 20, reputation: 5 }, feedback: "è•­è¦æ›¹éš¨ï¼Œå¤©ä¸‹å¤ªå¹³ã€‚", historyNote: "æ¼¢åˆçµ±æ²»è€…å¸å–ç§¦äº¡æ•™è¨“ï¼Œæ¡ç”¨é“å®¶é»ƒè€ä¹‹è¡“ï¼Œè¼•å¾­è–„è³¦ï¼Œè®“ç™¾å§“ä¼‘é¤Šç”Ÿæ¯ã€‚" },
                    { text: "ç ”è®€é“å®¶ç¶“å…¸", nextId: "han_wenjing", effect: { knowledge: 20, reputation: 5 }, feedback: "ä½ é ˜æ‚Ÿäº†æ¸…éœç„¡ç‚ºçš„é“ç†ã€‚", historyNote: "åœ¨æ¼¢æ­¦å¸ç¨å°Šå„’è¡“ä¹‹å‰ï¼Œé»ƒè€æ€æƒ³æ˜¯æ¼¢åˆçš„ä¸»æµæ”¿æ²»æ€æƒ³ã€‚" }
                ]
            },
            "han_wenjing": {
                id: "han_wenjing",
                title: "9. æ–‡æ™¯ä¹‹æ²» (è¥¿å…ƒå‰180-141å¹´)",
                text: "è¼•å¾­è–„è³¦ï¼Œç™¾å§“å¯Œåº¶ã€‚åœ‹åº«è£¡çš„éŒ¢ç¹©éƒ½çˆ›äº†ã€‚é€™æ˜¯ä¸­åœ‹æ­·å²ä¸Šç¬¬ä¸€å€‹ç››ä¸–ã€‚",
                imageType: "coin",
                options: [
                    { text: "å¤§åŠ›ç¶“å•†", nextId: "han_seven_states", effect: { wealth: 50, knowledge: 5 }, feedback: "ä½ æˆç‚ºäº†é•·å®‰åŸçš„å¯Œå•†ã€‚", historyNote: "æ–‡æ™¯æ™‚æœŸå•†æ¥­ç¹æ¦®ï¼Œå•†äººåœ°ä½æœ‰æ‰€æå‡ï¼Œä½†ä»å—ã€Œé‡è¾²æŠ‘å•†ã€æ”¿ç­–é™åˆ¶ã€‚" },
                    { text: "èˆˆè¾¦ç§å­¸", nextId: "han_seven_states", effect: { knowledge: 20, reputation: 20, wealth: -10 }, feedback: "ä½ æ¡ƒææ»¿å¤©ä¸‹ã€‚", historyNote: "æ¼¢æ–‡å¸å»¢é™¤äº†ç§¦æœçš„ã€ŒæŒ¾æ›¸å¾‹ã€ï¼Œæ°‘é–“è¬›å­¸ä¹‹é¢¨èˆˆèµ·ï¼Œæ–‡åŒ–é–‹å§‹å¾©ç”¦ã€‚" }
                ]
            },
            "han_seven_states": {
                id: "han_seven_states",
                title: "10. ä¸ƒåœ‹ä¹‹äº‚ (è¥¿å…ƒå‰154å¹´)",
                text: "æ¼¢æ™¯å¸æ¡ç´æ™éŒ¯å»ºè­°ã€Œå‰Šè—©ã€ï¼Œå³ç‹åŠ‰æ¿è¯åˆå…­åœ‹èµ·å…µé€ åã€‚æˆ°ç«é€¼è¿‘ã€‚",
                imageType: "sword",
                options: [
                    { text: "æŠ•èº«å‘¨äºå¤«è»å¹³å› (éœ€è²æœ›20)", nextId: "han_wu_ideology", reqReputation: 20, effect: { reputation: 30, health: -20, wealth: 20 }, feedback: "ä¸‰å€‹æœˆå¹³å®šä¸ƒåœ‹ä¹‹äº‚ï¼Œä½ ç«‹ä¸‹æˆ°åŠŸï¼", historyNote: "å‘¨äºå¤«åƒ…ç”¨ä¸‰å€‹æœˆå°±å¹³å®šäº†ä¸ƒåœ‹ä¹‹äº‚ï¼ŒåŠ å¼·äº†ä¸­å¤®é›†æ¬Šï¼Œç‚ºæ¼¢æ­¦å¸çš„å¤§ä¸€çµ±å¥ å®šäº†åŸºç¤ã€‚" },
                    { text: "æè³‡åŠ©è»", nextId: "han_wu_ideology", effect: { wealth: -30, reputation: 10 }, feedback: "ä½ çš„è²¡å¯Œå¹«åŠ©æœå»·ç©©å®šäº†å±€å‹¢ã€‚", historyNote: "æ¼¢æ™¯å¸ç‚ºäº†å¹³å›ï¼Œæ®ºäº†æ™éŒ¯è©¦åœ–è¬ç½ªï¼Œä½†å›è»ä¸¦æœªåœæ­¢ï¼Œæœ€çµ‚åªèƒ½æ­¦åŠ›å¹³å®šã€‚" },
                    { text: "èº²é¿æˆ°äº‚", nextId: "han_wu_ideology", effect: { health: 5, wealth: -10, reputation: -5 }, feedback: "ä½ å¹³å®‰åº¦éï¼Œä½†éŒ¯å¤±äº†å»ºåŠŸç«‹æ¥­çš„æ©Ÿæœƒã€‚", historyNote: "ä¸ƒåœ‹ä¹‹äº‚å¾Œï¼Œè«¸ä¾¯ç‹çš„æ¬ŠåŠ›è¢«å¤§å¹…å‰Šå¼±ï¼Œå†ä¹Ÿç„¡åŠ›å°æŠ—ä¸­å¤®ã€‚" }
                ]
            },
            "han_wu_ideology": {
                id: "han_wu_ideology",
                title: "11. ç¨å°Šå„’è¡“ (è¥¿å…ƒå‰134å¹´)",
                text: "æ¼¢æ­¦å¸å³ä½ï¼Œæ¡ç´ã€è‘£ä»²èˆ’ã€‘å»ºè­°ï¼Œã€Œç½·é»œç™¾å®¶ï¼Œç¨å°Šå„’è¡“ã€ï¼Œå»ºç«‹å¤ªå­¸ã€‚",
                imageType: "bookopen",
                options: [
                    { text: "é€²å…¥å¤ªå­¸æ”»è®€äº”ç¶“ (éœ€æ™ºåŠ›30)", nextId: "han_wu_eco", reqKnowledge: 30, effect: { knowledge: 30, reputation: 10, health: -5 }, feedback: "ä½ æˆç‚ºäº†å¤©å­é–€ç”Ÿï¼Œå£«äººæ”¿åºœçš„ä¸€å“¡ã€‚", historyNote: "å¤ªå­¸æ˜¯æ¼¢ä»£æœ€é«˜å­¸åºœï¼Œå°ˆé–€æ•™æˆå„’å®¶äº”ç¶“ã€‚æˆç¸¾å„ªç§€è€…å¯ç›´æ¥åšå®˜ï¼Œé€™é–‹å•Ÿäº†å£«äººæ”¿åºœçš„å±€é¢ã€‚" },
                    { text: "å …æŒé»ƒè€æ€æƒ³", nextId: "han_wu_eco", effect: { reputation: -10, knowledge: 5 }, feedback: "ä½ çš„æ€æƒ³å·²ä¸åˆæ™‚å®œï¼Œä»•é€”å—é˜»ã€‚", historyNote: "å„’å®¶æ€æƒ³å¾æ­¤æˆç‚ºä¸­åœ‹å…©åƒå¤šå¹´çš„æ­£çµ±æ€æƒ³ï¼Œå¼·èª¿å›æ¬Šç¥æˆå’Œå¤§ä¸€çµ±ã€‚" }
                ]
            },
            "han_wu_eco": {
                id: "han_wu_eco",
                title: "12. é¹½éµå®˜ç‡Ÿ (è¥¿å…ƒå‰119å¹´)",
                text: "ç‚ºç±Œæªè»è²»ï¼Œæ¼¢æ­¦å¸ä»»ç”¨ã€æ¡‘å¼˜ç¾Šã€‘æ¨è¡Œé¹½éµå®˜ç‡Ÿã€å‡è¼¸å¹³æº–ã€‚",
                imageType: "coin",
                options: [
                    { text: "æ”¯æŒå®˜ç‡Ÿï¼Œæ‰“æ“Šå›¤ç©å±…å¥‡", nextId: "han_zhang_qian", effect: { reputation: 10, wealth: 20, knowledge: 10 }, feedback: "åœ‹åº«å……ç›ˆï¼Œç‚ºåŒ—ä¼æä¾›äº†åŸºç¤ã€‚", historyNote: "é¹½éµå®˜ç‡Ÿå°‡æœ€è³ºéŒ¢çš„é¹½éµè¡Œæ¥­æ”¶æ­¸åœ‹æœ‰ï¼Œæ¥µå¤§å¢åŠ äº†è²¡æ”¿æ”¶å…¥ï¼Œä½†ä¹Ÿæ‰“æ“Šäº†æ°‘é–“å·¥å•†æ¥­ã€‚" },
                    { text: "åå°å®˜ç‡Ÿï¼Œèªç‚ºèˆ‡æ°‘çˆ­åˆ©", nextId: "han_zhang_qian", effect: { reputation: 20, wealth: -10, knowledge: 10 }, feedback: "ä½ è´å¾—äº†æ°‘é–“å•†è³ˆçš„å°Šé‡ã€‚", historyNote: "æ¼¢æ˜­å¸æ™‚æ›¾å¬é–‹ã€Œé¹½éµæœƒè­°ã€ï¼Œè¾¯è«–å®˜ç‡Ÿæ”¿ç­–çš„å¾—å¤±ï¼Œé€™æ˜¯ä¸­åœ‹æ­·å²ä¸Šè‘—åçš„ç¶“æ¿Ÿæ”¿ç­–å¤§è¾¯è«–ã€‚" }
                ]
            },
            "han_zhang_qian": {
                id: "han_zhang_qian",
                title: "13. é‘¿ç©ºè¥¿åŸŸ (è¥¿å…ƒå‰138-126å¹´)",
                text: "ã€å¼µé¨«ã€‘å‡ºä½¿è¥¿åŸŸï¼Œå°‹æ‰¾å¤§æœˆæ°å¤¾æ“ŠåŒˆå¥´ã€‚é€™æ˜¯ä¸€æ¢å……æ»¿æœªçŸ¥èˆ‡å±éšªçš„é“è·¯ã€‚",
                imageType: "map",
                options: [
                    { text: "éš¨å¼µé¨«å‡ºä½¿ (éœ€é«”åŠ›50)", nextId: "han_war", reqHealth: 50, effect: { health: -30, reputation: 40, wealth: 30, knowledge: 20 }, feedback: "ä½ å¸¶å›äº†è‘¡è„ã€è‹œè“¿ï¼Œé–‹é—¢äº†çµ²ç¶¢ä¹‹è·¯ï¼", historyNote: "å¼µé¨«å‡ºä½¿è¥¿åŸŸé›–ç„¶æ²’é”æˆè»äº‹ç›®çš„ï¼Œä½†æ‰“é€šäº†ä¸­è¥¿äº¤é€šï¼Œä¿ƒé€²äº†çµ²ç¶¢ä¹‹è·¯çš„ç¹æ¦®ã€‚" },
                    { text: "ç•™å®ˆé•·å®‰ç¹ªè£½åœ°åœ–", nextId: "han_war", effect: { knowledge: 20, wealth: 10, reputation: 5 }, feedback: "ä½ æ•´ç†äº†è¥¿åŸŸçš„åœ°ç†æƒ…å ±ã€‚", historyNote: "æ¼¢æœéš¨å¾Œåœ¨è¥¿åŸŸè¨­ç«‹äº†ã€Œè¥¿åŸŸéƒ½è­·åºœã€ï¼Œæ­£å¼å°‡è¥¿åŸŸç´å…¥ç‰ˆåœ–ã€‚" }
                ]
            },
            "han_war": {
                id: "han_war",
                title: "14. æ¼ åŒ—æ±ºæˆ° (è¥¿å…ƒå‰119å¹´)",
                text: "è¡›é’ã€éœå»ç—…ç‡å¤§è»æ·±å…¥æ¼ åŒ—ã€‚é€™æ˜¯æ¼¢åŒˆæˆ°çˆ­æœ€é«˜æ½®ã€‚",
                imageType: "sword",
                options: [
                    { text: "è¿½éš¨éœå»ç—…å°ç‹¼å±…èƒ¥ (éœ€é«”åŠ›60)", nextId: "han_su_wu", reqHealth: 60, effect: { reputation: 50, health: -40, wealth: 20, knowledge: 10 }, feedback: "åŒˆå¥´é éï¼Œæ¼ å—ç„¡ç‹åº­ï¼ä½ æˆç‚ºäº†ä¸€ä»£åå°‡ã€‚", historyNote: "éœå»ç—…å¹´å°‘æˆåï¼Œå°ç‹¼å±…èƒ¥å±±ï¼Œæ˜¯æ­¦å°‡çš„æœ€é«˜æ¦®è­½ã€‚æ¼¢æœæ­¤æˆ°å¾¹åº•æ“Šæ½°äº†åŒˆå¥´ä¸»åŠ›ã€‚" },
                    { text: "æ“”ä»»å¾Œå‹¤é‹ç³§", nextId: "han_su_wu", effect: { health: -10, wealth: 10, reputation: 5 }, feedback: "å…µé¦¬æœªå‹•ï¼Œç³§è‰å…ˆè¡Œã€‚", historyNote: "æ¼¢æ­¦å¸é€£å¹´å¾æˆ°ï¼Œé›–ç„¶æ­¦åŠŸæ¥µç››ï¼Œä½†ä¹Ÿå°è‡´ã€Œæµ·å…§è™›è€—ï¼Œæˆ¶å£æ¸›åŠã€ã€‚" }
                ]
            },
            "han_su_wu": {
                id: "han_su_wu",
                title: "15. è˜‡æ­¦ç‰§ç¾Š (è¥¿å…ƒå‰100å¹´)",
                text: "è˜‡æ­¦å‡ºä½¿åŒˆå¥´è¢«æ‰£ç•™ï¼Œæµæ”¾åŒ—æµ·ç‰§ç¾Šåä¹å¹´ï¼ŒæŒç¯€ä¸å±ˆã€‚",
                imageType: "desert",
                options: [
                    { text: "è¨­æ³•ç‚ºè˜‡æ­¦é€å»é£Ÿç‰© (éœ€è²¡å¯Œ30)", nextId: "han_sima", reqWealth: 30, effect: { wealth: -20, reputation: 30 }, feedback: "ä½ çš„ç¾©èˆ‰è®“è˜‡æ­¦å¾—ä»¥å …æŒä¸‹å»ã€‚", historyNote: "è˜‡æ­¦åœ¨åŒ—æµ·ï¼ˆä»Šè²åŠ çˆ¾æ¹–ï¼‰æŒ–é‡é¼ æ´ã€åƒè‰æ ¹ï¼Œå …æŒæ¼¢ç¯€ä¸é™ï¼Œæˆç‚ºå¿ å›æ„›åœ‹çš„å…¸ç¯„ã€‚" },
                    { text: "å‹¸èªªåŒˆå¥´å–®äºæ”¾äºº (éœ€æ™ºåŠ›50)", nextId: "han_sima", reqKnowledge: 50, effect: { knowledge: 10, reputation: 20 }, feedback: "é›–ç„¶å–®äºæœªå®Œå…¨ç­”æ‡‰ï¼Œä½†æ”¹å–„äº†æ¼¢ä½¿å¾…é‡ã€‚", historyNote: "ç›´åˆ°æ¼¢æ˜­å¸æ™‚æœŸï¼Œæ¼¢åŒˆå’Œè¦ªï¼Œè˜‡æ­¦æ‰å¾—ä»¥ç²é‡‹å›åœ‹ã€‚" },
                    { text: "æ„Ÿå˜†å¿ ç¾©ï¼Œè‡ªè¡Œé›¢å»", nextId: "han_sima", effect: { knowledge: 5 }, feedback: "ä½ è¦‹è­‰äº†ä½•ç‚ºæ°£ç¯€ã€‚", historyNote: "æé™µå‹¸é™è˜‡æ­¦å¤±æ•—ï¼Œç¾æ„§é›¢å»ã€‚å…©äººçš„é¸æ“‡æˆç‚ºåƒå¤è©±é¡Œã€‚" }
                ]
            },
            "han_sima": {
                id: "han_sima",
                title: "16. ç©¶å¤©äººä¹‹éš› (è¥¿å…ƒå‰99å¹´)",
                text: "ã€å¸é¦¬é·ã€‘å› æé™µæ¡ˆä¸‹ç„ï¼Œé¢è‡¨ç”Ÿæ­»æŠ‰æ“‡ã€‚",
                imageType: "history",
                options: [
                    { text: "å‚¾å®¶è•©ç”¢ç‚ºå¸é¦¬é·è´–ç½ª (éœ€è²¡å¯Œ80)", nextId: "han_zhaojun", reqWealth: 80, effect: { wealth: -80, reputation: 30, knowledge: 10 }, feedback: "ä½ çš„ç¾©èˆ‰éœ‡é©šæœé‡ï¼Œé›–æœªæ•‘å‡ºï¼Œä½†æƒ…ç¾©åƒå¤ã€‚", historyNote: "æ¼¢å¾‹è¦å®šå¯ä»¥ç”¨éŒ¢è´–æ­»ç½ªï¼Œä½†å¸é¦¬é·å®¶è²§ä¸”ç„¡äººç›¸åŠ©ï¼Œæœ€çµ‚é¸æ“‡æ¥å—å®®åˆ‘ä»¥å®Œæˆå²è¨˜ã€‚" },
                    { text: "ç„ä¸­æ¢æœ›ï¼Œé¼“å‹µè‘—æ›¸", nextId: "han_zhaojun", effect: { knowledge: 30, reputation: 10 }, feedback: "ã€Šå²è¨˜ã€‹å¾—ä»¥å®Œæˆï¼Œä½ è¦‹è­‰äº†æ­·å²çš„èª•ç”Ÿã€‚", historyNote: "å¸é¦¬é·ç™¼æ†¤è‘—æ›¸ï¼Œå¯«æˆã€Šå²è¨˜ã€‹ï¼Œè¢«é­¯è¿…è­½ç‚ºã€Œå²å®¶ä¹‹çµ•å”±ï¼Œç„¡éŸ»ä¹‹é›¢é¨·ã€ã€‚" }
                ]
            },
            "han_zhaojun": {
                id: "han_zhaojun",
                title: "17. æ˜­å›å‡ºå¡ (è¥¿å…ƒå‰33å¹´)",
                text: "æ¼¢å…ƒå¸æ™‚æœŸï¼Œå‘¼éŸ“é‚ªå–®äºä¾†æœæ±‚è¦ªã€‚å®®å¥³ç‹æ˜­å›ä¸»å‹•è«‹çº“å‡ºå¡å’Œè¦ªã€‚",
                imageType: "map",
                options: [
                    { text: "è­·é€æ˜­å›å‡ºå¡ (éœ€é«”åŠ›30)", nextId: "wang_mang", reqHealth: 30, effect: { health: -20, reputation: 20, wealth: 20, knowledge: 10 }, feedback: "é‚Šç–†ç¶­æŒäº†åŠå€‹ä¸–ç´€çš„å’Œå¹³ï¼Œä½ ä¸€è·¯è­·é€æœ‰åŠŸã€‚", historyNote: "æ˜­å›å‡ºå¡ç‚ºæ¼¢åŒˆå¸¶ä¾†äº†60å¹´çš„å’Œå¹³ï¼Œæ˜¯æ°‘æ—èåˆçš„ä½³è©±ã€‚" },
                    { text: "ç•«å¸«æ¯›å»¶å£½ç´¢è³„ï¼Œäºˆä»¥æ­ç™¼", nextId: "wang_mang", effect: { reputation: 15, wealth: 0, health: 0, knowledge: 5 }, feedback: "æ¯›å»¶å£½ä¼æ³•ï¼Œä½†æ˜­å›å·²é å»ã€‚", historyNote: "å‚³èªªæ¯›å»¶å£½å› æ˜­å›ä¸è‚¯è³„è³‚ï¼Œæ•…æ„å°‡å…¶ç•«é†œã€‚æ¼¢å…ƒå¸è¦‹æ˜­å›ç¾è²Œå¾Œæ‚”ä¸å·²ï¼Œæ®ºäº†æ¯›å»¶å£½ã€‚" }
                ]
            },
            "wang_mang": {
                id: "wang_mang",
                title: "18. ç‹è½èˆ‡æ–°æœ (è¥¿å…ƒ9å¹´)",
                text: "ç‹è½ç¯¡æ¼¢ï¼Œå»ºç«‹æ–°æœï¼Œæ¨è¡Œã€Œç‹ç”°åˆ¶ã€èˆ‡å¹£åˆ¶æ”¹é©ï¼Œå¤©ä¸‹å¤§äº‚ã€‚",
                imageType: "refresh",
                options: [
                    { text: "é è¦‹å¹£åˆ¶å´©æ½°ï¼Œå›¤ç©é»ƒé‡‘ (éœ€æ™ºåŠ›40)", nextId: "han_guangwu", reqKnowledge: 40, effect: { knowledge: 20, wealth: 30 }, feedback: "ä½ çš„ç¶“æ¿Ÿé ­è…¦è®“ä½ åœ¨äº‚ä¸–ä¸­ä¿å…¨äº†è³‡ç”¢ã€‚", historyNote: "ç‹è½å››æ¬¡æ”¹é©å¹£åˆ¶ï¼Œè²¨å¹£ç¨®é¡ç¹é›œï¼Œå°è‡´ç¶“æ¿Ÿå´©æ½°ï¼Œç™¾å§“ç ´ç”¢ã€‚" },
                    { text: "åŠ å…¥ç¶ æ—èµ¤çœ‰èµ·ç¾©", nextId: "han_guangwu", effect: { health: -20, reputation: 20, wealth: 10 }, feedback: "æ–°æœæ»…äº¡ï¼Œå…‰æ­¦ä¸­èˆˆã€‚", historyNote: "ç‹è½æ”¹åˆ¶é›–ç„¶ç«‹æ„è‰¯å¥½ï¼ˆå¦‚å»¢é™¤å¥´éš¸ï¼‰ï¼Œä½†è„«é›¢ç¾å¯¦ï¼Œæœ€çµ‚è¢«ç¶ æ—ã€èµ¤çœ‰è»æ¨ç¿»ã€‚" }
                ]
            },
            "han_guangwu": {
                id: "han_guangwu",
                title: "19. å…‰æ­¦ä¸­èˆˆ (è¥¿å…ƒ25å¹´)",
                text: "åŠ‰ç§€åœ¨æ˜†é™½ä¹‹æˆ°ä»¥å°‘å‹å¤šï¼Œæœ€çµ‚çµ±ä¸€å…¨åœ‹ï¼Œå»ºç«‹æ±æ¼¢ï¼Œå®šéƒ½æ´›é™½ã€‚",
                imageType: "han_palace",
                options: [
                    { text: "æŠ•å¥”åŠ‰ç§€ï¼Œæˆç‚ºé–‹åœ‹åŠŸè‡£ (éœ€è²æœ›30)", nextId: "han_ban_chao", reqReputation: 30, effect: { reputation: 30, wealth: 40, health: -10, knowledge: 10 }, feedback: "æŸ”é“æ²»åœ‹ï¼Œå¤©ä¸‹é‡æ­¸ä¸€çµ±ã€‚", historyNote: "å…‰æ­¦å¸åŠ‰ç§€æ¨è¡Œã€ŒæŸ”é“ã€æ²»åœ‹ï¼Œé‡‹æ”¾å¥´å©¢ï¼Œé€€åŠŸè‡£é€²æ–‡åï¼Œé–‹å‰µäº†ã€Œå…‰æ­¦ä¸­èˆˆã€ã€‚" },
                    { text: "è§£ç”²æ­¸ç”°ï¼Œå®‰å¿ƒç¨®åœ°", nextId: "han_ban_chao", effect: { health: 20, wealth: 10 }, feedback: "ä½ äº«å—äº†ä¹…é•çš„å’Œå¹³ã€‚", historyNote: "æ±æ¼¢åˆæœŸç¤¾æœƒç¶“æ¿Ÿæ¢å¾©è¿…é€Ÿï¼Œäººå£å¤§å¹…å¢é•·ã€‚" }
                ]
            },
            "han_ban_chao": {
                id: "han_ban_chao",
                title: "20. æŠ•ç­†å¾æˆ (è¥¿å…ƒ73å¹´)",
                text: "ç­è¶…ä¸é¡˜åªæ˜¯æŠ„å¯«æ–‡æ›¸ï¼Œæ±ºå®šæ”¾ä¸‹æ¯›ç­†ï¼Œå‡ºä½¿è¥¿åŸŸï¼Œé‡æŒ¯æ¼¢æœè²å¨ã€‚",
                imageType: "desert",
                options: [
                    { text: "æ•ˆæ³•ç­è¶…ï¼Œå‡ºä½¿è¥¿åŸŸ", nextId: "east_han_politics", effect: { knowledge: 10, reputation: 20, health: -10, wealth: 10 }, feedback: "ä¸å…¥è™ç©´ï¼Œç„‰å¾—è™å­ï¼", historyNote: "ç­è¶…ç¶“ç‡Ÿè¥¿åŸŸä¸‰åå¹´ï¼Œåƒ…é å°‘é‡å…µåŠ›å°±æ”¶æœäº†è¥¿åŸŸäº”åå¤šåœ‹ï¼Œé‡æ–°æ‰“é€šçµ²ç¶¢ä¹‹è·¯ã€‚" },
                    { text: "ç¹¼çºŒåšæ–‡æ›¸å·¥ä½œ", nextId: "east_han_politics", effect: { knowledge: 5, wealth: 10, health: 5 }, feedback: "å¹³ç©©ä¸€ç”Ÿä¹Ÿæ˜¯ä¸€ç¨®é¸æ“‡ã€‚", historyNote: "æ±æ¼¢ä¸­æœŸä»¥å¾Œï¼Œæ–‡å®˜é›†åœ˜é€æ¼¸å½¢æˆï¼Œèˆ‡å¾Œä¾†çš„å¤–æˆšã€å®¦å®˜å½¢æˆæ”¿æ²»è§’åŠ›ã€‚" }
                ]
            },
            "east_han_politics": {
                id: "east_han_politics",
                title: "21. å¤–æˆšèˆ‡å®¦å®˜ (è¥¿å…ƒ100å¹´å·¦å³)",
                text: "æ±æ¼¢ä¸­æœŸä»¥å¾Œï¼Œçš‡å¸å¹´å¹¼ï¼Œå¤ªåè‡¨æœï¼Œå¤–æˆšå°ˆæ¬Šã€‚çš‡å¸é•·å¤§å¾Œå¾€å¾€ä¾é å®¦å®˜å¥ªæ¬Šã€‚",
                imageType: "crown",
                options: [
                    { text: "ä¾é™„å¤–æˆšç«‡æ°", nextId: "han_tech", effect: { wealth: 30, reputation: -10, health: -10 }, feedback: "ä¸€æ™‚æ¬Šå‹¢æ»”å¤©ï¼Œä½†å¥½æ™¯ä¸é•·ã€‚", historyNote: "å¤–æˆšç«‡æ†²é›–ç„¶æ“Šæ•—åŒˆå¥´å‹’çŸ³ç‡•ç„¶ï¼Œä½†å› å°ˆæ¬Šæœ€çµ‚è¢«æ¼¢å’Œå¸è¯åˆå®¦å®˜èª…æ®ºã€‚" },
                    { text: "çµäº¤æ¸…æµåå£« (éœ€æ™ºåŠ›50)", nextId: "han_tech", reqKnowledge: 50, effect: { reputation: 20, knowledge: 10 }, feedback: "ä½ ä¿æŒäº†æ°£ç¯€ï¼Œå—äººå°Šæ•¬ã€‚", historyNote: "å£«å¤§å¤«éšå±¤ï¼ˆæ¸…æµï¼‰æŠ¨æ“Šæ™‚æ”¿ï¼Œåå°å®¦å®˜å°ˆæ¬Šï¼Œå°è‡´äº†å¾Œä¾†çš„é»¨éŒ®ä¹‹ç¦ã€‚" },
                    { text: "é é›¢æœå ‚", nextId: "han_tech", effect: { health: 10, knowledge: 5 }, feedback: "çœ¼ä¸è¦‹ç‚ºæ·¨ã€‚", historyNote: "æ±æ¼¢æœ«å¹´æ”¿æ²»é»‘æš—ï¼Œè¨±å¤šçŸ¥è­˜åˆ†å­é¸æ“‡éš±å±…ä¸ä»•ã€‚" }
                ]
            },
            "han_tech": {
                id: "han_tech",
                title: "22. ç§‘æŠ€å·”å³° (è¥¿å…ƒ105-132å¹´)",
                text: "æ±æ¼¢æ™‚æœŸï¼Œè”¡å€«æ”¹é€²é€ ç´™è¡“ï¼Œå¼µè¡¡ç™¼æ˜åœ°å‹•å„€ã€‚",
                imageType: "scroll",
                options: [
                    { text: "æŠ•è³‡é€ ç´™è¡“æ¨å»£ (éœ€è²¡å¯Œ40)", nextId: "han_disaster", reqWealth: 40, effect: { knowledge: 30, reputation: 20, wealth: -20 }, feedback: "æ–‡æ˜å› ç´™å¼µè€Œå‚³æ‰¿ï¼Œä½ åŠŸä¸å¯æ²’ã€‚", historyNote: "è”¡å€«ç”¨æ¨¹çš®ã€éº»é ­ç­‰å»‰åƒ¹åŸæ–™é€ ç´™ï¼ˆè”¡ä¾¯ç´™ï¼‰ï¼Œä½¿ç´™å¼µå–ä»£ç°¡ç‰˜æˆç‚ºä¸»è¦æ›¸å¯«ææ–™ã€‚" },
                    { text: "èˆ‡å¼µè¡¡è§€æ¸¬æ˜Ÿè±¡", nextId: "han_disaster", effect: { knowledge: 40, health: 10, reputation: 10 }, feedback: "ä½ æ´æ‚‰äº†å®‡å®™çš„å¥§ç§˜ã€‚", historyNote: "å¼µè¡¡ä¸åƒ…ç™¼æ˜äº†å€™é¢¨åœ°å‹•å„€ï¼Œé‚„æå‡ºäº†ã€Œæ¸¾å¤©èªªã€ï¼Œæ˜¯æ±æ¼¢æœ€å‰å¤§çš„ç§‘å­¸å®¶ã€‚" }
                ]
            },
            "han_disaster": {
                id: "han_disaster",
                title: "23. é»¨éŒ®ä¹‹ç¦ (è¥¿å…ƒ166å¹´)",
                text: "å®¦å®˜å°ˆæ¬Šï¼Œæ‰“å£“å£«å¤§å¤«ã€‚æœå»·ä¸‹ä»¤é€®æ•ã€Œé»¨äººã€ï¼Œæ”¿æ²»é»‘æš—ã€‚",
                imageType: "prison",
                options: [
                    { text: "ç‡Ÿæ•‘è¢«è¿«å®³çš„åå£« (éœ€é«”åŠ›30)", nextId: "yellow_turban", reqHealth: 30, effect: { reputation: 40, health: -30, wealth: -20, knowledge: 10 }, feedback: "æ¥µåº¦å±éšªï¼Œä½†ä½ è´å¾—äº†å¤©ä¸‹çš„æ•¬é‡ã€‚", historyNote: "èŒƒæ»‚ç­‰åå£«å¯§æ­»ä¸å±ˆï¼Œå±•ç¾äº†å£«å¤§å¤«çš„æ°£ç¯€ã€‚é»¨éŒ®ä¹‹ç¦å‹•æ–äº†æ±æ¼¢çš„çµ±æ²»æ ¹åŸºã€‚" },
                    { text: "ä¾é™„å®¦å®˜ä»¥æ±‚è‡ªä¿", nextId: "yellow_turban", effect: { wealth: 50, reputation: -50 }, feedback: "ä½ ä¿å…¨äº†æ€§å‘½ï¼Œå»å¤±å»äº†åè²ã€‚", historyNote: "ç•¶æ™‚æ°‘é–“æœ‰è«ºèªï¼šã€Œèˆ‰ç§€æ‰ï¼Œä¸çŸ¥æ›¸ï¼›èˆ‰å­å»‰ï¼Œçˆ¶åˆ¥å±…ã€ï¼Œè«·åˆºé¸å®˜åˆ¶åº¦çš„è…æ•—ã€‚" },
                    { text: "éš±å±…å±±æ—", nextId: "yellow_turban", effect: { knowledge: 10, health: 10, wealth: -10 }, feedback: "é¿ä¸–ä¸å‡ºã€‚", historyNote: "äº‚ä¸–ä¹‹ä¸­ï¼Œè¨±å¤šäººé¸æ“‡æ˜å“²ä¿èº«ï¼Œç­‰å¾…æ™‚æ©Ÿã€‚" }
                ]
            },
            "yellow_turban": {
                id: "yellow_turban",
                title: "24. é»ƒå·¾èµ·ç¾© (è¥¿å…ƒ184å¹´)",
                text: "ã€Œè’¼å¤©å·²æ­»ï¼Œé»ƒå¤©ç•¶ç«‹ï¼ã€å¼µè§’ç‡é ˜è¾²æ°‘èµ·ç¾©ï¼Œå¤©ä¸‹å¤§äº‚ï¼Œç¾¤é›„ä¸¦èµ·ã€‚",
                imageType: "rebellion",
                options: [
                    { text: "çµ„ç¹”ç¾©å…µï¼Œä¿è¡›å®¶åœ’ (éœ€è²æœ›50)", nextId: "dong_zhuo", reqReputation: 50, effect: { reputation: 30, health: -20, wealth: 10, knowledge: 10 }, feedback: "ä½ æˆç‚ºäº†ä¸€æ–¹è±ªå¼·ã€‚", historyNote: "ç‚ºäº†é®å£“é»ƒå·¾è»ï¼Œæœå»·ä¸‹æ”¾è»æ¬Šçµ¦åœ°æ–¹å·ç‰§ï¼Œå°è‡´äº†å¾Œä¾†çš„è»é–¥å‰²æ“šã€‚" },
                    { text: "åŠ å…¥é»ƒå·¾è»", nextId: "dong_zhuo", effect: { health: -10, wealth: 20, reputation: -10 }, feedback: "æ¶ç³§æ¶éŒ¢ï¼Œä½†æœ€çµ‚è¢«é®å£“ã€‚", historyNote: "é»ƒå·¾èµ·ç¾©æ˜¯ä¸­åœ‹æ­·å²ä¸Šè¦æ¨¡æœ€å¤§çš„ä»¥å®—æ•™å½¢å¼çµ„ç¹”çš„è¾²æ°‘èµ·ç¾©ï¼Œæ²‰é‡æ‰“æ“Šäº†æ±æ¼¢çµ±æ²»ã€‚" },
                    { text: "æ”œå®¶å¸¶çœ·é€ƒé›£", nextId: "dong_zhuo", effect: { health: -20, wealth: -20 }, feedback: "æµé›¢å¤±æ‰€ï¼Œè‹¦ä¸å ªè¨€ã€‚", historyNote: "æˆ°äº‚å°è‡´äººå£éŠ³æ¸›ï¼Œã€Œç™½éª¨éœ²æ–¼é‡ï¼Œåƒé‡Œç„¡é›é³´ã€ã€‚" }
                ]
            },
            "dong_zhuo": {
                id: "dong_zhuo",
                title: "25. è‘£å“äº‚æ”¿ (è¥¿å…ƒ189å¹´)",
                text: "è‘£å“é€²äº¬ï¼Œå»¢å°‘å¸ï¼Œç«‹ç»å¸ï¼Œç«ç‡’æ´›é™½ã€‚é€™æ˜¯æ­·å²æ—…ç¨‹çš„çµ‚é»ï¼Œä½ çš„é¸æ“‡å°‡æ±ºå®šæœ€å¾Œçš„çµå±€ã€‚",
                imageType: "fire",
                options: [
                    { text: "æŸ¥çœ‹æœ€çµ‚è©•åƒ¹", nextId: "ending_calc", effect: { health: 0 }, feedback: "æ­·å²çš„è»Šè¼ªç¹¼çºŒæ»¾å‹•...", historyNote: "è‘£å“ä¹‹äº‚æ¨™èªŒè‘—æ±æ¼¢åå­˜å¯¦äº¡ï¼Œä¸‰åœ‹äº‚ä¸–æ­£å¼æ‹‰é–‹åºå¹•ã€‚" }
                ]
            },
            // çµå±€è¨ˆç®—
            "ending_calc": {
                id: "ending_calc",
                title: "è¨ˆç®—æ­·å²è©•åƒ¹...",
                text: "...",
                isCalc: true
            },
            // çµå±€
            "ending_emperor": {
                id: "ending_emperor",
                title: "ã€çµå±€ï¼šåƒå¤ä¸€å¸ / äº‚ä¸–æ¢Ÿé›„ã€‘",
                text: "ä½ çš„è²æœ›èˆ‡è²¡å¯Œé”åˆ°äº†é ‚å³°ï¼Œæ™ºè¬€æ›´æ˜¯æ·±ä¸å¯æ¸¬ã€‚åœ¨äº‚ä¸–ä¸­ï¼Œä½ æœ‰èƒ½åŠ›åƒã€ç§¦å§‹çš‡ã€‘ä¸€æ¨£æƒå¹³å…­åˆï¼Œæˆ–åƒã€æ¼¢å…‰æ­¦å¸ã€‘ä¸€æ¨£ä¸­èˆˆæ¼¢å®¤ã€‚ä½ æ˜¯å¤©ç”Ÿçš„çµ±æ²»è€…ï¼Œæ­·å²å°‡ç”±ä½ ä¾†æ›¸å¯«ã€‚",
                imageType: "crown"
            },
            // çµå±€ - æ–‡è‡£
            "ending_scholar": {
                id: "ending_scholar",
                title: "ã€çµå±€ï¼šåšå¤é€šä»Š / æ–‡å£‡é ˜è¢–ã€‘",
                text: "ä½ çš„æ™ºæ…§è¶…ç¾¤ï¼Œå­¸è­˜æ·µåšã€‚ä½ å¦‚åŒã€è‘£ä»²èˆ’ã€‘èˆ¬æå‡ºå¤©äººæ„Ÿæ‡‰ï¼Œç¢ºç«‹å„’è¡“ç¨å°Šï¼›åˆæˆ–åƒã€å¸é¦¬é·ã€‘ä¸€èˆ¬ï¼Œå¿è¾±è² é‡ï¼Œä»¥æ­¤èº«æ›¸å¯«ã€Šå²è¨˜ã€‹ã€‚æœä»£èˆˆè¡°è½‰é ­ç©ºï¼Œå”¯æœ‰ä½ çš„æ–‡ç« åƒå¤æµå‚³ã€‚",
                imageType: "bookopen"
            },
            // çµå±€ - æ­¦å°‡
            "ending_general": {
                id: "ending_general",
                title: "ã€çµå±€ï¼šå¸åœ‹é›™ç’§ / é–‹åœ‹å¤§å°‡ã€‘",
                text: "ä½ çš„å‹‡æ­¦èˆ‡è²æœ›ä»¤äººæ•¬ç•ã€‚ä½ å°±åƒã€è¡›é’ã€‘ã€ã€éœå»ç—…ã€‘ä¸€æ¨£ï¼Œç‡é ˜éµé¨è¸ç ´åŒˆå¥´ç‹åº­ï¼Œå°ç‹¼å±…èƒ¥ï¼›æˆ–æ˜¯åƒã€éŸ“ä¿¡ã€‘ä¸€æ¨£ï¼Œæ±ºå‹åƒé‡Œï¼Œåœ‹å£«ç„¡é›™ã€‚ä½ çš„åå­—å°‡æˆç‚ºè»éšŠçš„åœ–é¨°ã€‚",
                imageType: "sword"
            },
            // çµå±€ - å•†äºº
            "ending_rich": {
                id: "ending_rich",
                title: "ã€çµå±€ï¼šå¯Œç”²å¤©ä¸‹ / ç¶“æ¿Ÿå·¨æ“˜ã€‘",
                text: "ä½ æ´æ‚‰ç¶“æ¿Ÿè¦å¾‹ï¼Œç´¯ç©äº†é©šäººçš„è²¡å¯Œã€‚ä½ å°±åƒã€å‘‚ä¸éŸ‹ã€‘ä¸€æ¨£å¥‡è²¨å¯å±…ï¼Œç”šè‡³èƒ½ä»¥å•†äººçš„èº«ä»½å·¦å³åœ‹å®¶æ”¿æ²»ï¼›æˆ–åƒã€æ¡‘å¼˜ç¾Šã€‘ä¸€æ¨£æŒæ¡åœ‹å®¶è²¡æ”¿è„ˆæã€‚åœ¨é€™å€‹æ™‚ä»£ï¼ŒéŒ¢è²¡ä¹Ÿæ˜¯ä¸€ç¨®å¼·å¤§çš„æ­¦å™¨ã€‚",
                imageType: "coin"
            },
            // çµå±€ - å¹³æ°‘
            "ending_commoner": {
                id: "ending_commoner",
                title: "ã€çµå±€ï¼šæ­¸éš±ç”°åœ’ / æ­·å²è¦‹è­‰è€…ã€‘",
                text: "ä½ çœ‹ç›¡äº†ç§¦çš‡æ¼¢æ­¦çš„è±åŠŸå‰æ¥­ï¼Œä¹Ÿè¦‹è­‰äº†æˆ°ç«ç´›é£›çš„ç”Ÿéˆå¡—ç‚­ã€‚ä½ é¸æ“‡åƒã€åš´å…‰ã€‘ï¼ˆåš´å­é™µï¼‰ä¸€æ¨£ä¸äº‹ç‹ä¾¯ï¼Œæ­¸éš±å±±æ—ã€‚é›–ç„¶å²æ›¸ä¸Šæ²’æœ‰ä½ çš„åå­—ï¼Œä½†ä½ å¹³å®‰åœ°åº¦éäº†æ³¢ç€¾å£¯é—Šçš„ä¸€ç”Ÿï¼Œé€™æˆ–è¨±æ‰æ˜¯æœ€å¤§çš„ç¦æ°£ã€‚",
                imageType: "classroom"
            },
            "game_over": {
                id: "game_over",
                title: "å£¯å¿—æœªé…¬",
                text: "ä½ çš„é«”åŠ›è€—ç›¡ï¼Œå€’åœ¨äº†æ­·å²çš„é•·æ²³ä¸­...",
                imageType: "loose"
            }
        };

        // --- éš¨æ©Ÿæ­·å²äººç‰©äº‹ä»¶æ±  ---
        const randomEvents = [
            { name: "ææ–¯", text: "ä½ åœ¨è·¯é‚Šå¶é‡ææ–¯ï¼Œä»–æ­£åœ¨æ€è€ƒå€‰é¼ èˆ‡å»é¼ çš„å“²å­¸ã€‚", effect: { knowledge: 5 }, msg: "è½å›ä¸€å¸­è©±ï¼Œæ™ºåŠ›+5" },
            { name: "éŸ“ä¿¡", text: "ä½ çœ‹åˆ°ä¸€å€‹å¹´è¼•äººå—èƒ¯ä¸‹ä¹‹è¾±ï¼Œä½ æ–½æ¨äº†ä»–ä¸€ç¢—é£¯ã€‚", effect: { reputation: 10 }, msg: "éŸ“ä¿¡è¨˜ä½äº†ä½ çš„æ©æƒ…ï¼Œè²æœ›+10" },
            { name: "æ±æ–¹æœ”", text: "æ»‘ç¨½å¤šæ™ºçš„æ±æ–¹æœ”å·å–äº†æ¼¢æ­¦å¸çš„é•·ç”Ÿé…’ï¼Œåˆ†äº†ä½ ä¸€å£ã€‚", effect: { health: 10 }, msg: "ä½ æ„Ÿè¦ºç²¾ç¥ç™¾å€ï¼Œé«”åŠ›+10" },
            { name: "å“æ–‡å›", text: "ä½ åœ¨é…’è‚†è½åˆ°ç´è²ï¼ŒåŸä¾†æ˜¯å“æ–‡å›èˆ‡å¸é¦¬ç›¸å¦‚ç•¶å£šè³£é…’ã€‚", effect: { wealth: -10, knowledge: 10 }, msg: "ä½ è²·äº†é…’ä¸¦è†è½ç´éŸ³ï¼Œè²¡å¯Œ-10ï¼Œæ™ºåŠ›+10" },
            { name: "è¯ä½—", text: "ç¥é†«è¯ä½—è·¯éï¼Œç‚ºä½ æŠŠè„ˆã€‚", effect: { health: 20 }, msg: "ç¶“éèª¿ç†ï¼Œé«”åŠ›+20" },
            { name: "èŠè»»", text: "æ˜“æ°´æ²³ç•”ï¼Œä½ é‡åˆ°ä¸€ä½é«˜æ¼¸é›¢æ“Šç­‘é€åˆ¥çš„å£¯å£«ã€‚", effect: { reputation: 10, health: -5 }, msg: "è¢«å£¯å£«è±ªæ°£æ„ŸæŸ“ï¼Œè²æœ›+10ï¼Œä½†å–å¤šäº†é«”åŠ›-5" },
            { name: "è•­ä½•", text: "æœˆä¸‹ï¼Œä½ çœ‹åˆ°ä¸€äººç­–é¦¬æ€¥è¿½ã€‚", effect: { knowledge: 10 }, msg: "è¦‹è­‰è•­ä½•æœˆä¸‹è¿½éŸ“ä¿¡ï¼Œæ™ºåŠ›+10" },
            { name: "ç´°å›å…¬ä¸»", text: "é å«çƒå­«çš„å…¬ä¸»æ€é„‰å¿ƒåˆ‡ï¼Œä½ ç‚ºå¥¹å½ˆå¥äº†ä¸€æ›²çµç¶ã€‚", effect: { reputation: 15 }, msg: "å…¬ä¸»è´ˆä½ è¥¿åŸŸå¯¶çŸ³ï¼Œè²æœ›+15" },
            { name: "é¦¬æ´", text: "è€ç•¶ç›Šå£¯çš„é¦¬æ´å°‡è»æ­£åœ¨å †ç±³ç‚ºå±±ï¼Œæ¨æ¼”æˆ°è¡“ã€‚", effect: { knowledge: 10, health: 5 }, msg: "å­¸ç¿’è»äº‹åœ°ç†ï¼Œæ™ºåŠ›+10ï¼Œé«”åŠ›+5" },
            { name: "è¨±æ…", text: "ä½ é‡åˆ°æ­£åœ¨ç·¨å¯«ã€Šèªªæ–‡è§£å­—ã€‹çš„è¨±æ…ã€‚", effect: { knowledge: 15 }, msg: "å­¸ç¿’æ–‡å­—å­¸ï¼Œæ™ºåŠ›+15" }
        ];

        const SceneDisplay = ({ imageType }) => {
            const getVisual = (type) => {
                switch(type) {
                    case 'classroom': return <div className="flex flex-col items-center text-stone-700"><Icons.BookOpen /><span className="mt-2">ç¾ä»£æ•™å®¤</span></div>;
                    case 'qin_palace': return <div className="flex flex-col items-center text-stone-900"><div className="text-6xl">ğŸ°</div><span className="mt-2 font-bold">å’¸é™½å®®</span></div>;
                    case 'qin_wall': return <div className="flex flex-col items-center text-stone-700"><div className="text-6xl">ğŸ§±</div><span className="mt-2 font-bold">è¬é‡Œé•·åŸ</span></div>;
                    case 'fire': return <div className="flex flex-col items-center text-red-600"><div className="text-6xl">ğŸ”¥</div><span className="mt-2 font-bold">æˆ°ç«ç´›é£›</span></div>;
                    case 'rebellion': return <div className="flex flex-col items-center text-yellow-700"><div className="text-6xl">ğŸš©</div><span className="mt-2 font-bold">æ­ç«¿èµ·ç¾©</span></div>;
                    case 'tent': return <div className="flex flex-col items-center text-stone-800"><div className="text-6xl">â›º</div><span className="mt-2 font-bold">è¡Œè»å¸³</span></div>;
                    case 'han_palace': return <div className="flex flex-col items-center text-red-800"><Icons.Crown /><span className="mt-2 font-bold">æœªå¤®å®®</span></div>;
                    case 'farm': return <div className="flex flex-col items-center text-green-700"><div className="text-6xl">ğŸŒ¾</div><span className="mt-2 font-bold">è¾²ç”°</span></div>;
                    case 'desert': return <div className="flex flex-col items-center text-amber-600"><div className="text-6xl">ğŸ«</div><span className="mt-2 font-bold">è¥¿åŸŸå¤§æ¼ </span></div>;
                    case 'battle': return <div className="flex flex-col items-center text-stone-900"><Icons.Sword /><span className="mt-2 font-bold">å¤æˆ°å ´</span></div>;
                    case 'prison': return <div className="flex flex-col items-center text-gray-600"><div className="text-6xl">â›“ï¸</div><span className="mt-2 font-bold">å»·å°‰ç„</span></div>;
                    case 'xin': return <div className="flex flex-col items-center text-green-800"><div className="text-6xl">ğŸ’°</div><span className="mt-2 font-bold">æ–°æœå¸‚é›†</span></div>;
                    case 'scroll': return <div className="flex flex-col items-center text-stone-600"><Icons.Scroll /><span className="mt-2 font-bold">æ›¸æˆ¿</span></div>;
                    case 'scale': return <div className="flex flex-col items-center text-stone-600"><Icons.Refresh /><span className="mt-2 font-bold">åº¦é‡è¡¡</span></div>;
                    case 'hammer': return <div className="flex flex-col items-center text-stone-600"><div className="text-6xl">ğŸ”¨</div><span className="mt-2 font-bold">å·¥åœ°</span></div>;
                    case 'map': return <div className="flex flex-col items-center text-amber-800"><Icons.Map /><span className="mt-2 font-bold">åœ°åœ–</span></div>;
                    case 'coin': return <div className="flex flex-col items-center text-yellow-600"><Icons.Coin /><span className="mt-2 font-bold">åœ‹åº«</span></div>;
                    case 'bookopen': return <div className="flex flex-col items-center text-blue-800"><Icons.BookOpen /><span className="mt-2 font-bold">å¤ªå­¸</span></div>;
                    case 'history': return <div className="flex flex-col items-center text-stone-800"><Icons.History /><span className="mt-2 font-bold">å²æ›¸</span></div>;
                    case 'award': return <div className="flex flex-col items-center text-yellow-500"><Icons.Award /><span className="mt-2 font-bold">å‚³å¥‡</span></div>;
                    case 'sword': return <div className="flex flex-col items-center text-red-800"><Icons.Sword /><span className="mt-2 font-bold">å¾æˆ°</span></div>;
                    case 'crown': return <div className="flex flex-col items-center text-yellow-600"><Icons.Crown /><span className="mt-2 font-bold">å¸ç‹</span></div>;
                    case 'loose': return <div className="flex flex-col items-center text-gray-500"><div className="text-6xl">âš°ï¸</div><span className="mt-2">éŠæˆ²çµæŸ</span></div>;
                    default: return <div className="flex justify-center"><Icons.History /></div>;
                }
            };

            const getBgColor = (type) => {
                if (['qin_palace', 'qin_wall', 'prison', 'hammer', 'scale'].includes(type)) return 'bg-stone-300';
                if (['fire', 'han_palace', 'battle', 'sword'].includes(type)) return 'bg-red-100';
                if (['desert', 'rebellion', 'map'].includes(type)) return 'bg-amber-100';
                if (['farm', 'xin', 'coin', 'crown'].includes(type)) return 'bg-emerald-100';
                if (['bookopen', 'scroll', 'history'].includes(type)) return 'bg-blue-100';
                if (['award'].includes(type)) return 'bg-yellow-100';
                if (type === 'loose') return 'bg-gray-300';
                return 'bg-stone-100';
            };

            return (
                <div className={`w-full h-64 rounded-lg border-4 border-double border-stone-500 mb-6 flex items-center justify-center shadow-inner ${getBgColor(imageType)} fade-in transition-colors duration-500`}>
                    <div className="transform hover:scale-110 transition-transform duration-300 scale-110">
                        {getVisual(imageType)}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [currentSceneId, setCurrentSceneId] = useState('intro');
            const [stats, setStats] = useState({ health: 100, knowledge: 10, wealth: 20, reputation: 0 });
            const [feedback, setFeedback] = useState(null);
            const [shake, setShake] = useState(false);
            const [randomEvent, setRandomEvent] = useState(null); 
            const [selectedOption, setSelectedOption] = useState(null); 
            const [seenEventIndices, setSeenEventIndices] = useState(new Set());
            // æ–°å¢ç‹€æ…‹ï¼šç­‰å¾…ç©å®¶ç¢ºèªä¸‹ä¸€æ­¥
            const [waitingForNext, setWaitingForNext] = useState(false);
            const [nextSceneId, setNextSceneId] = useState(null);

            const currentScene = storyNodes[currentSceneId];

            // çµå±€èˆ‡éš¨æ©Ÿäº‹ä»¶é‚è¼¯
            useEffect(() => {
                // çµå±€è¨ˆç®—
                if (currentScene?.isCalc) {
                    let nextId = 'ending_commoner';
                    if (stats.health <= 0) nextId = 'game_over';
                    else if (stats.reputation > 80 && stats.wealth > 80 && stats.knowledge > 60) nextId = 'ending_emperor';
                    else if (stats.reputation > 70 && stats.health > 60) nextId = 'ending_general';
                    else if (stats.knowledge > 80) nextId = 'ending_scholar';
                    else if (stats.wealth > 90) nextId = 'ending_rich';
                    
                    setTimeout(() => setCurrentSceneId(nextId), 1500);
                } 
                // éš¨æ©Ÿäº‹ä»¶è§¸ç™¼ (éçµå±€ã€éintroã€ä¸”æ©Ÿç‡35%)
                else if (!currentSceneId.startsWith('ending') && currentSceneId !== 'intro' && currentSceneId !== 'game_over' && !randomEvent && !waitingForNext) {
                    if (Math.random() < 0.35) {
                        const availableIndices = randomEvents.map((_, i) => i).filter(i => !seenEventIndices.has(i));
                        
                        if (availableIndices.length > 0) {
                            const randIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
                            setRandomEvent(randomEvents[randIndex]);
                            setSeenEventIndices(prev => new Set(prev).add(randIndex));
                        }
                    }
                }
            }, [currentSceneId, waitingForNext]); // åŠ å…¥ waitingForNext ä¾è³´ï¼Œé¿å…åœ¨ç­‰å¾…æ™‚è§¸ç™¼

            const handleRandomEvent = () => {
                if (!randomEvent) return;
                
                let newStats = { ...stats };
                Object.keys(randomEvent.effect).forEach(key => {
                    newStats[key] += randomEvent.effect[key];
                });
                setStats(newStats);
                showFeedback(`ã€å¥‡é‡ã€‘${randomEvent.msg}`, 'event');
                setRandomEvent(null); 
            };

            const handleChoice = (option, index) => {
                // 1. æª¢æŸ¥æ¢ä»¶
                if (option.reqKnowledge && stats.knowledge < option.reqKnowledge) {
                    triggerShake(); showFeedback(`æ™ºåŠ›ä¸è¶³ï¼éœ€ ${option.reqKnowledge}`, 'error'); return;
                }
                if (option.reqHealth && stats.health < option.reqHealth) {
                    triggerShake(); showFeedback(`é«”åŠ›ä¸è¶³ï¼éœ€ ${option.reqHealth}`, 'error'); return;
                }
                if (option.reqWealth && stats.wealth < option.reqWealth) {
                    triggerShake(); showFeedback(`è²¡å¯Œä¸è¶³ï¼éœ€ ${option.reqWealth}`, 'error'); return;
                }
                if (option.reqReputation && stats.reputation < option.reqReputation) {
                    triggerShake(); showFeedback(`è²æœ›ä¸è¶³ï¼éœ€ ${option.reqReputation}`, 'error'); return;
                }

                // 2. æ¨™è¨˜é¸æ“‡çš„é¸é … & é€²å…¥ç­‰å¾…ç‹€æ…‹
                setSelectedOption(index);
                setWaitingForNext(true);

                // 3. è¨ˆç®—æ•¸å€¼è®ŠåŒ–
                let newStats = { ...stats };
                const effect = option.effect || {};
                
                if (effect.health) newStats.health += effect.health;
                if (effect.knowledge) newStats.knowledge += effect.knowledge;
                if (effect.wealth) newStats.wealth += effect.wealth;
                if (effect.reputation) newStats.reputation += effect.reputation;

                setStats(newStats);

                if (option.feedback) {
                    showFeedback(option.feedback, 'story');
                }

                // 4. è¨­å®šä¸‹ä¸€é—œ ID (ä½†ä¸è·³è½‰ï¼Œç­‰å¾…æŒ‰éˆ•)
                if (newStats.health <= 0) {
                    setNextSceneId('game_over');
                } else {
                    setNextSceneId(option.nextId);
                }
            };

            // æ‰‹å‹•è§¸ç™¼ä¸‹ä¸€æ­¥
            const handleNextStep = () => {
                if (!nextSceneId) return;
                setCurrentSceneId(nextSceneId);
                setSelectedOption(null);
                setWaitingForNext(false);
                setNextSceneId(null);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const showFeedback = (msg, type) => {
                setFeedback({ msg, type });
                setTimeout(() => setFeedback(null), 3000);
            };

            const triggerShake = () => {
                setShake(true);
                setTimeout(() => setShake(false), 500);
            };

            const resetGame = () => {
                setCurrentSceneId('intro');
                setStats({ health: 100, knowledge: 10, wealth: 20, reputation: 0 });
                setRandomEvent(null);
                setSelectedOption(null);
                setSeenEventIndices(new Set());
                setWaitingForNext(false);
            };

            const isEnding = currentScene.id.startsWith('ending') || currentScene.id === 'game_over';

            return (
                <div className="min-h-screen flex items-center justify-center py-6 px-4 font-serif">
                    <div className={`max-w-3xl w-full scroll-container rounded-xl overflow-hidden border-8 border-stone-700 relative ${shake ? 'shake' : ''}`}>
                        
                        {/* Header */}
                        <div className="bg-stone-800 text-amber-50 p-4 shadow-md sticky top-0 z-20">
                            <div className="flex justify-between items-end mb-3 border-b border-stone-600 pb-2">
                                <h1 className="font-bold text-xl tracking-widest text-amber-400">æ™‚å…‰è¡Œè€…ï¼šç§¦æ¼¢ç¯‡</h1>
                                <div className="text-xs text-stone-400">äº’å‹•æ­·å²æ•™æ</div>
                            </div>
                            <div className="grid grid-cols-4 gap-2 text-sm">
                                <div className="flex flex-col items-center bg-stone-700/50 rounded p-2 transition-all hover:bg-stone-600">
                                    <div className="flex items-center gap-1 text-red-300 mb-1"><Icons.Heart /> é«”åŠ›</div>
                                    <span className="font-bold text-lg">{stats.health}</span>
                                </div>
                                <div className="flex flex-col items-center bg-stone-700/50 rounded p-2 transition-all hover:bg-stone-600">
                                    <div className="flex items-center gap-1 text-blue-300 mb-1"><Icons.Brain /> æ™ºåŠ›</div>
                                    <span className="font-bold text-lg">{stats.knowledge}</span>
                                </div>
                                <div className="flex flex-col items-center bg-stone-700/50 rounded p-2 transition-all hover:bg-stone-600">
                                    <div className="flex items-center gap-1 text-yellow-300 mb-1"><Icons.Coin /> è²¡å¯Œ</div>
                                    <span className="font-bold text-lg">{stats.wealth}</span>
                                </div>
                                <div className="flex flex-col items-center bg-stone-700/50 rounded p-2 transition-all hover:bg-stone-600">
                                    <div className="flex items-center gap-1 text-purple-300 mb-1"><Icons.Star /> è²æœ›</div>
                                    <span className="font-bold text-lg">{stats.reputation}</span>
                                </div>
                            </div>
                        </div>

                        {/* Content */}
                        <div className="p-6 md:p-8 relative min-h-[600px]">
                            
                            {/* éš¨æ©Ÿäº‹ä»¶å½ˆçª— (Fixedç½®ä¸­) */}
                            {randomEvent && (
                                <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 fade-in">
                                    <div className="bg-stone-100 p-6 rounded-lg max-w-md w-full text-center border-4 border-amber-600 shadow-2xl">
                                        <h3 className="text-2xl font-bold text-amber-800 mb-4">âœ¨ æ­·å²å¥‡é‡ âœ¨</h3>
                                        <div className="text-xl font-bold text-stone-800 mb-2">{randomEvent.name}</div>
                                        <p className="text-stone-600 mb-6">{randomEvent.text}</p>
                                        <button 
                                            onClick={handleRandomEvent}
                                            className="bg-amber-600 text-white px-6 py-2 rounded hover:bg-amber-700 font-bold w-full"
                                        >
                                            æ¥å—å‘½é‹
                                        </button>
                                    </div>
                                </div>
                            )}

                            {/* åé¥‹è¨Šæ¯ - Fixed å®šä½å±…ä¸­ */}
                            {feedback && (
                                <div className={`fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 px-6 py-3 rounded shadow-xl border-2 animate-bounce text-center font-bold ${feedback.type === 'error' ? 'bg-red-600 text-white border-white' : 'bg-stone-800 text-amber-400 border-amber-500'}`}>
                                    {feedback.msg}
                                </div>
                            )}

                            {/* æ¨™é¡Œèˆ‡å ´æ™¯ */}
                            <div className="mb-8">
                                <h2 className="text-3xl font-bold text-center mb-6 text-stone-800 border-b-4 border-stone-300 pb-4 mx-4">
                                    {currentScene.title}
                                </h2>
                                {!currentScene.isCalc && <SceneDisplay imageType={currentScene.imageType} />}
                            </div>

                            {/* å…§æ–‡ */}
                            <div className="prose prose-xl max-w-none text-stone-800 leading-relaxed mb-8 bg-white/50 p-6 rounded-xl shadow-sm border border-stone-200">
                                {currentScene.text}
                            </div>

                            {/* é¸é … */}
                            <div className="grid gap-4">
                                {!isEnding ? (
                                    currentScene.options && currentScene.options.map((opt, idx) => (
                                        <div 
                                            key={idx}
                                            onClick={() => !selectedOption && handleChoice(opt, idx)}
                                            className={`group text-left p-5 border-2 rounded-xl transition-all shadow relative overflow-hidden transform 
                                                ${selectedOption === idx 
                                                    ? 'bg-amber-100 border-amber-500 ring-2 ring-amber-300 scale-100 z-10 cursor-default' 
                                                    : selectedOption !== null 
                                                        ? 'bg-gray-100 border-gray-200 opacity-40 cursor-not-allowed grayscale' 
                                                        : 'bg-white border-stone-300 hover:border-stone-600 hover:bg-stone-50 hover:-translate-y-1 hover:shadow-lg cursor-pointer'
                                                }`}
                                        >
                                            <div className="font-bold text-lg text-stone-900 z-10 relative mb-1 flex justify-between items-center">
                                                {opt.text}
                                                {selectedOption === idx && <span className="text-amber-600 animate-pulse text-sm">âœ” å·²é¸æ“‡</span>}
                                            </div>
                                            
                                            {/* é¸æ“‡å‰ï¼šåªé¡¯ç¤ºæ¢ä»¶æç¤º */}
                                            {!selectedOption && (
                                                <div className="text-sm text-stone-500 flex flex-wrap gap-3 opacity-80">
                                                    {opt.reqKnowledge && <span className="flex items-center gap-1 text-blue-600"><Icons.Brain /> éœ€ {opt.reqKnowledge}</span>}
                                                    {opt.reqHealth && <span className="flex items-center gap-1 text-red-600"><Icons.Heart /> éœ€ {opt.reqHealth}</span>}
                                                    {opt.reqWealth && <span className="flex items-center gap-1 text-yellow-600"><Icons.Coin /> éœ€ {opt.reqWealth}</span>}
                                                    {opt.reqReputation && <span className="flex items-center gap-1 text-purple-600"><Icons.Star /> éœ€ {opt.reqReputation}</span>}
                                                </div>
                                            )}

                                            {/* é¸æ“‡å¾Œï¼šé¡¯ç¤ºæ•¸å€¼è®ŠåŒ–çµæœã€å²å¯¦è£œå……èˆ‡ä¸‹ä¸€æ­¥æŒ‰éˆ• */}
                                            {selectedOption === idx && (
                                                <div className="mt-3 animate-in fade-in slide-in-from-top-2 duration-300">
                                                    <div className="p-3 bg-white/90 rounded border border-amber-200 text-sm">
                                                        <div className="flex flex-wrap gap-3 font-bold mb-2 border-b border-gray-200 pb-2">
                                                            {opt.effect?.health && <span className={opt.effect.health > 0 ? 'text-green-600' : 'text-red-600'}>é«”åŠ› {opt.effect.health > 0 ? '+' : ''}{opt.effect.health}</span>}
                                                            {opt.effect?.wealth && <span className="text-yellow-600">è²¡å¯Œ {opt.effect.wealth > 0 ? '+' : ''}{opt.effect.wealth}</span>}
                                                            {opt.effect?.reputation && <span className="text-purple-600">è²æœ› {opt.effect.reputation > 0 ? '+' : ''}{opt.effect.reputation}</span>}
                                                            {opt.effect?.knowledge && <span className="text-blue-600">æ™ºåŠ› {opt.effect.knowledge > 0 ? '+' : ''}{opt.effect.knowledge}</span>}
                                                            {(!opt.effect || Object.values(opt.effect).every(v => v === 0)) && <span className="text-gray-500">æ•¸å€¼ç„¡è®ŠåŒ–</span>}
                                                        </div>
                                                        {opt.historyNote && (
                                                            <div className="text-stone-700 leading-relaxed mb-3">
                                                                <strong className="text-amber-700 block mb-1">ğŸ’¡ æ­·å²å°è¬›å ‚ï¼š</strong>
                                                                {opt.historyNote}
                                                            </div>
                                                        )}
                                                        
                                                        {/* ä¸‹ä¸€æ­¥æŒ‰éˆ• */}
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); handleNextStep(); }}
                                                            className="w-full py-2 bg-stone-800 text-amber-50 rounded hover:bg-stone-700 font-bold shadow-md flex items-center justify-center gap-2 transition-colors"
                                                        >
                                                            å‰å¾€ä¸‹ä¸€é—œ <Icons.ArrowRight />
                                                        </button>
                                                    </div>
                                                </div>
                                            )}
                                            
                                            {!selectedOption && (
                                                <div className="absolute right-5 top-1/2 transform -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity text-stone-400">
                                                    <Icons.ArrowRight />
                                                </div>
                                            )}
                                        </div>
                                    ))
                                ) : (
                                    <button onClick={resetGame} className="w-full p-5 bg-stone-800 text-amber-50 rounded-xl hover:bg-stone-700 flex items-center justify-center gap-3 font-bold text-xl shadow-xl transition-all transform hover:scale-105">
                                        <Icons.Refresh /> é‡æ–°é–‹å§‹æ­·å²ä¹‹æ—…
                                    </button>
                                )}
                            </div>
                        </div>

                        <div className="bg-stone-200 text-center py-3 text-sm text-stone-600 border-t border-stone-300">
                            æ­·å²äº’å‹•æ•™æ v3.0 | ç§¦æ¼¢ç¯‡
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>